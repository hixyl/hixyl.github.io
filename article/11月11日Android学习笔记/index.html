<!DOCTYPE html><html lang="zh"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/a34f9d1faa5f3315-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/aae87c042353adfd.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/99f6a99e5e57ec87.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/d0df4e9d9cd28850.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/c033a265c4b6e7f8.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/81abeb1d965206f7.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/a46a6036119d7d12.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/51cbc18a5b192d8f.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-33ea8a143bfabde9.js"/><script src="/_next/static/chunks/fd9d1056-62aaf4b921c84028.js" async=""></script><script src="/_next/static/chunks/23-020bd7ae6b960732.js" async=""></script><script src="/_next/static/chunks/main-app-aeb5213bc864b27a.js" async=""></script><script src="/_next/static/chunks/app/layout-950680b5068c0831.js" async=""></script><script src="/_next/static/chunks/221e729c-e5a67d23aac7644c.js" async=""></script><script src="/_next/static/chunks/9316e0b3-81def07e0919db1c.js" async=""></script><script src="/_next/static/chunks/974-9ffea8f9ea4bfaa2.js" async=""></script><script src="/_next/static/chunks/536-12c341f043d96047.js" async=""></script><script src="/_next/static/chunks/665-f7c57b2084cbed6b.js" async=""></script><script src="/_next/static/chunks/app/article/%5Bid%5D/page-28a3798f9eb189fc.js" async=""></script><link rel="preload" href="https://www.googletagmanager.com/gtag/js?id=G-N3DJ3JTVT2" as="script"/><link rel="icon" href="/favicon.png?&lt;generated&gt;" type="image/&lt;generated&gt;" sizes="&lt;generated&gt;"/><title>11月11日Android学习笔记 - 流年石刻</title><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="__className_36bd41"><div class="article_pageBody__Bryg4"><div class="header_header__us6ao"><div class="header_topHeader__xNJQ1"><a href="/"><div class="header_logo__IbzcJ">流年石刻</div></a><div class="menu_menuBox__ZCxZE"><a href="/"><p style="--icon-unSelected:url(/icons/home_gray.svg);--icon-selected:url(/icons/home_black.svg)" class="menu_navListItem__znGi9">首页</p></a><a href="/articles/all/1/"><p style="--icon-unSelected:url(/icons/article_gray.svg);--icon-selected:url(/icons/article_black.svg)" class="menu_navListItemSelected__JZBTq">文章</p></a><a href="/about/"><p style="--icon-unSelected:url(/icons/about_gray.svg);--icon-selected:url(/icons/about_black.svg)" class="menu_navListItem__znGi9">关于</p></a><a href="/search/"><p style="--icon-unSelected:url(/icons/search_gray.svg);--icon-selected:url(/icons/search_black.svg)" class="menu_navListItem__znGi9">搜索</p></a></div><div class="header_iconArea__Co05n"><img alt="menu" loading="lazy" width="30" height="30" decoding="async" data-nimg="1" class="header_menuIcon__7dQN0" style="color:transparent" src="/_next/static/media/menu.c309d6d5.svg"/></div></div><div class="mobileMenu_mobileMenu__Mz_1e mobileMenu_menuContainer__hndoP "><a href="/"><div style="--icon-unSelected:url(/icons/home_gray.svg);--icon-selected:url(/icons/home_black.svg)" class="mobileMenu_item__pY1st ">首页</div></a><a href="/articles/all/1/"><div style="--icon-unSelected:url(/icons/article_gray.svg);--icon-selected:url(/icons/article_black.svg)" class="mobileMenu_item__pY1st mobileMenu_itemSelected__d5YAL">文章</div></a><a href="/about/"><div style="--icon-unSelected:url(/icons/about_gray.svg);--icon-selected:url(/icons/about_black.svg)" class="mobileMenu_item__pY1st ">关于</div></a><a href="/search/"><div style="--icon-unSelected:url(/icons/search_gray.svg);--icon-selected:url(/icons/search_black.svg)" class="mobileMenu_item__pY1st ">搜索</div></a></div></div><div class="article_pageBodyMain___x_AF"><div class="sidebar_sidebar__6HDFv sidebar_open__ia_Zv"><div class="sidebar_sidebarInner__NiyBR"><div class="topImgBox_topImgBox__2OSEr"><img alt="" loading="lazy" width="1024" height="1024" decoding="async" data-nimg="1" class="topImgBox_topImg__6hmTH" style="color:transparent" src="/_next/static/media/author.2cacf696.jpg"/><div class="topImgBox_textArea__iSnnz"><div class="topImgBox_author__URTnh">星玉龙</div><div class="topImgBox_position__7qz_f">前端工程师</div><a class="topImgBox_email__skkTy" href="mailto:me@timeshike.com">me@timeshike.com</a><a class="topImgBox_githubBtn__YYbAh" href="https://github.com/hixyl">Github</a><div class="topImgBox_content__lmDiZ">闲云潭影，物换星移<br/>滕王高阁，几度春秋<br/>故人不在，长江空流<br/>月圆复缺，岁月悠悠<br/></div><div class="topImgBox_bottomBtns__EIkFU"><a href="/atom.xml"><img alt="rss" loading="lazy" width="20" height="20" decoding="async" data-nimg="1" style="color:transparent" src="/_next/static/media/rss.d066fc0f.svg"/></a></div></div></div></div><div class="sidebar_btnArea__Wtf3d"><div class="sidebar_btnRect__RQ7s5"><img alt="rightArray" loading="lazy" width="200" height="200" decoding="async" data-nimg="1" class="sidebar_imgBtn__gmp3y" style="color:transparent" src="/_next/static/media/left_array.0dce0964.svg"/></div></div></div><div class="article_articleContainer__uRwUh scrollContent"><div class="article_articleBody__0coIY scrollContent"><h1 style="margin-bottom:0.1rem;margin-top:0.2rem">11月11日Android学习笔记</h1><div><div class="tags_tags__qM_Ja"><p class="tags_label__Rg6b2">分类</p><a href="/articles/新知笔记/1/"><p class="tags_tag__HZYxk tags_tagLink__gnw9V">新知笔记</p></a><a href="/articles/Android学习/1/"><p class="tags_tag__HZYxk tags_tagLink__gnw9V">Android学习</p></a></div><div class="tags_tags__qM_Ja"><p class="tags_label__Rg6b2">标签</p><p class="tags_tag__HZYxk ">Android</p><p class="tags_tag__HZYxk ">Thread</p><p class="tags_tag__HZYxk ">AsyncTask</p><p class="tags_tag__HZYxk ">Notification</p></div><div class="walinePageView_walinePageview__C8Aml"><img alt="" loading="lazy" width="25" height="25" decoding="async" data-nimg="1" style="color:transparent" src="/_next/static/media/eye.7eadf26d.svg"/><span style="font-size:0.9rem;color:gray" class="waline-pageview-count"></span></div></div><article>
    <p class="time">发布时间：<time datetime="11 November, 2022">2022-11-11 17:17:11</time></p>
    <p class="words">本文字数：2,028 字       阅读完需：约 5 分钟</p>
    <h2>Android 异步任务</h2>
<h3>InfoAsyncTask.java</h3>
<pre><code class="language-java">package com.xyl.app1111;

import android.app.ProgressDialog;
import android.content.Context;
import android.os.AsyncTask;
import android.text.TextUtils;
import android.util.Log;

import com.xyl.app1111.utils.HttpUtils;

public class InfoAsyncTask extends AsyncTask&#x3C;String, Void, String> {

    private Context context;
    private ProgressDialog dialog;
    public interface OnLoadDataListener{
        public void onSuccess(String json);
        public void onError();
    }
    private OnLoadDataListener onLoadDataListener;
    public void setOnLoadDataListener(OnLoadDataListener onLoadDataListener){
        this.onLoadDataListener = onLoadDataListener;
    }

    public InfoAsyncTask(Context context) {
        this.context = context;
    }

    /**
     * 在子线程开启之前被调用，运行在主线程当中，通常做进度对话框的初始化工作
     */
    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        dialog = new ProgressDialog(context);
        dialog.setMessage("正在加载中，请稍后");
        dialog.show();
    }

    /**
     * 开启线程，进行耗时操作
     * @param params
     * @return
     */
    @Override
    protected String doInBackground(String... params) {
        String s = HttpUtils.getStringByConnection(params[0]);
        return s;
    }

    /**
     * 计算下载的进度，在此处更新进度条
     * @param values
     */
    @Override
    protected void onProgressUpdate(Void... values) {
        super.onProgressUpdate(values);
    }

    /**
     * 运行在主线程当中，将耗时操作的结果以参数的形式显示在参数当中,result为doInBackground的返回值
     * @param result
     */
    @Override
    protected void onPostExecute(String result) {
        super.onPostExecute(result);
        dialog.dismiss();
        if (onLoadDataListener!=null) {
            if (!TextUtils.isEmpty(result)) {
                onLoadDataListener.onSuccess(result);
            }
            else{
                onLoadDataListener.onError();
            }
        }
    }
}

</code></pre>
<h3>异步请求底层模拟</h3>
<pre><code class="language-java">package com.animee.app1111.utils;


import android.os.Handler;
import android.os.Message;

import androidx.annotation.NonNull;

/**
 * 作者：animee on 2022/11/11 09:51
 */
public abstract  class AnimeeTask&#x3C;T,M> {

    protected void onPreExecute(){

    }
    protected abstract M doInBackground(T...params);
    protected void onPostExecute(M result){

    }

    public AnimeeTask(){
        onPreExecute();
    }

    public void execute(T...value){
        Thread thread = new Thread(new Runnable() {
            @Override
            public void run() {
                M m = doInBackground(value);
                //Message对象获取方法有三个
                Message msg = Message.obtain();
                msg.what = 1;
                msg.obj = m;
                handler.sendMessage(msg);

            }
        });
        thread.start();
    }
    Handler handler = new Handler(new Handler.Callback() {
        @Override
        public boolean handleMessage(@NonNull Message msg) {
            if (msg.what==1) {
                M m = (M) msg.obj;
                onPostExecute(m);
            }
            return false;
        }
    });
}

</code></pre>
<h3>知识点</h3>
<pre><code class="language-text">1.android处理网络请求等耗时操作的方法，有两种：
  1.异步任务   AsyncTask
  2.多线程和线程池    Handler

2.为什么要使用异步任务？
      1.Android是一个单线程模型，同时也是一个多线程操作系统。
    2.把耗时操作(读取文件，加载网络请求)放到子线程当中执行。
原因：android只能在主线程当中更新ui，即UI线程，不能在其他线程当中做更新ui的操作。
这样保证了程序的稳定性和准确性。
稳定性：避免了多线程同时操作ui，造成了线程混乱。
准备性：把耗时操作都放到子线程当中执行，就会避免了ANR(Android Not Responding)应用程序无响应异常。

3.AsyncTask为何而生？
       1.可以封装，简化异步操作
       2.获取网络数据，传递给主线程更新UI。

4.构建AsyncTask子类的参数、
AsyncTask&#x3C;params,progress,result>是一个抽象类。
通常用于被继承，继承这个asyncTask就需要指定三个泛型参数。
    Params:启动任务时输入参数的类型
    Progress：后台任务执行中返回进度值的类型
    Result: 后台任务执行完返回结果的类型。

5.继承AsyncTask当中需要重写的四个方法。

onPreExecute():后台操作前被调用，主要用于一些UI组件的初始化。（不做耗时操作）
doInBackground(Params...)：必须重写，异步任务要执行的操作必须在这个方法中执行。(执行耗时操作)
onPostExecute(Result):在doInBackground方法执行完成后，自动调用此方法，同时doInBackground方法返回的数据
            会作为此方法的参数。一般在此方法中去执行更新ui的操作。
onProgressUpdate(Progress...)：更新了任务执行就进度后，会触发的方法。在doInBackground方法当中调用
                publishProgress(Progress...)方法，此方法才会被系统调用。


6.AsyncTask的具体实现过程。
      1.写一个类，继承asyncTask，同时传入指定的三个泛型
    2.重写必要的两个方法。
            doInBackground();
        onPostExecute();
    3.重写可选的两个方法。
            onPreExecute();
        onProgressUpdate();
    4.在ui线程当中实例化，自定义的子类的对象。
    5.在ui线程当中，把asynctask的对象去执行execute的方法,就是执行了异步任务。


7.ScrollView  :  滚动组件
  父类是：Framelayout
   内部只能包含一个子类控件，通常这个控件是LinearLayout，可以在线性布局当中去放置其他控件。

8、android的view有一个表示显示状态的属性visibility。
  对应的值有三个：
   visible:设置控件可见
   invisible:设置控件不可见
   gone:设置控件隐藏
   invisible和gone的主要区别：当设置为invisible时，界面保留view控件所占据的空间。
   当设定为gone时，view隐藏并且不保留view控件所占据的空间。

9.AsyncTask的不足之处。
     1.AsyncTask如果在同一个界面当中加载很多接口，会开启大量的线程，会导致系统资源严重被占用，
      然后就会产生应用程序FC错误。（FC:应用程序强制关闭，崩溃）
   2.AsyncTask执行doinBackground方法时，即使调用了取消方法，也不能取消，要等到doinBackground
   方法中的代码执行结束后才能取消。
   3.线程池是不能维护的，当产生大量异步操作的时候线程池就满了，然后就会产生异常。

10.异步和同步
     同步：在同一个线程当中执行一系列的操作。
   异步：多个线程当中完成工作，最后通过多线程通信达到最终效果。

11.AsyncTask的取消。
     1.要在UI线程当中执行AsyncTask的cancel方法。
   2.要在doInBackground方法当中做一个判断，判断条件是是否被取消isCancelled(),如果未被取消才执行逻辑代码。
   3.cancel(true)   ：只要是执行了这个方法，AsyncTask立即被取消。
     cancel(false)  : 执行了这个方法，要等本次while中的内容执行完才被取消。

12.AsyncTask的注意事项：
      1.必须在UI线程当中创建AsyncTask的实例。
    2.必须在ui线程当中执行AsyncTask的execute的方法。
    3.重写的四个方法是系统自动调用的，我们不能手动的调用。
    4.每个asyncTask的实例只能被执行一次，多次执行就会出现异常。
</code></pre>
<h2>滚动分页加载</h2>
<pre><code class="language-java">   //ListView 滚动监听接口
    AbsListView.OnScrollListener listener = new AbsListView.OnScrollListener() {
        // 当滚动状态发生改变时，回调的方法
//        SCROLL_STATE_IDLE 停止状态  SCROLL_STATE_TOUCH_SCROLL 手指触摸滚动
//        SCROLL_STATE_FLING 惯性滚动
        @Override
        public void onScrollStateChanged(AbsListView view, int scrollState) {
            if (scrollState == SCROLL_STATE_IDLE
                    &#x26;&#x26; lastVisibleItem==adapter.getCount()) {
                //显示尾布局，并且开始加载
                footerView.setVisibility(View.VISIBLE);
                page++;
                String url = creatURL();
                loadDatas(url);
            }
        }
        //    firstVisibleItem：当前可见第一条的位置   visibleItemCount 可见条目数量   totalItemCount 一共有多少条
        @Override
        public void onScroll(AbsListView view, int firstVisibleItem, int visibleItemCount, int totalItemCount) {
            lastVisibleItem = firstVisibleItem+visibleItemCount-1;
        }
    };
</code></pre>
<h2>下拉刷新</h2>
<h3>build.gradle</h3>
<pre><code class="language-java">    implementation "androidx.swiperefreshlayout:swiperefreshlayout:1.0.0"
</code></pre>
<h3>使用</h3>
<pre><code class="language-java">    binding.srLayout.setColorSchemeColors(Color.RED);
    binding.srLayout.setOnRefreshListener(onRefreshListener);
    //    下拉刷新的监听接口
    SwipeRefreshLayout.OnRefreshListener onRefreshListener = new SwipeRefreshLayout.OnRefreshListener() {
        @Override
        public void onRefresh() {
            page=1;
            String url = creatURL();
            mDatas.clear();
            loadDatas(url);
        }
    };
</code></pre>
<h2>通知(Notification)</h2>
<h3>发送简单通知</h3>
<pre><code class="language-java">    /**
     * 发送简单通知
     */
    private void sendNormalNotify() {
        //创建通知的装饰对象
        Notification.Builder builder = new Notification.Builder(this);
        //设置通知显示内容
        builder.setContentTitle("好消息, 好消息！！！！");
        builder.setContentText("新冠疫情神奇消失了。。。");
        builder.setSmallIcon(R.mipmap.ib_luck_normal);
        Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.mipmap.jinniu);
        builder.setLargeIcon(bitmap);
        builder.setAutoCancel(true);
        builder.setOngoing(false);//侧滑能不能取消通知
        builder.setPriority(Notification.PRIORITY_HIGH);
        builder.setTicker("放心Go向你发来了双11问候，快来看我.....");
        //设置点击预先跳转意图
        Intent intent = new Intent(this, NewsInfoActivity.class);
        builder.setContentIntent(PendingIntent.getActivity(this, 100, intent, PendingIntent.FLAG_ONE_SHOT));
        //获取通知对象
        Notification notification = builder.build();
        //发送通知
        manager.notify(1, notification);
    }
</code></pre>
<h3>完整实例</h3>
<p>注意: Andorid</p>
<pre><code class="language-java">import androidx.appcompat.app.AppCompatActivity;

import android.app.Notification;
import android.app.NotificationChannel;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.content.Context;
import android.content.Intent;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.os.Build;
import android.os.Bundle;
import android.view.View;

/**
 * Notification  通知信息
 * 在应用中如果需要提示用户一些信息，显示在通知栏，可以发送Notification
 *
 * */
public class NotifyActivity extends AppCompatActivity {

    NotificationManager manager;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_notify);
        manager =
                (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
        createChannel();

    }
    private final String CHANNEL_ID = "com.animee.app1111";
    //渠道名
    private final String CHANNEL_NAME = "渠道名-简单通知";
    //渠道重要级
    private final int CHANNEL_IMPORTANCE = NotificationManager.IMPORTANCE_DEFAULT;
    private void createChannel() {
        //创建通知渠道，Android8.0及以上需要
        if (Build.VERSION.SDK_INT &#x3C; Build.VERSION_CODES.O) {
            return;
        }
        NotificationChannel notificationChannel = new NotificationChannel(
                CHANNEL_ID, CHANNEL_NAME, CHANNEL_IMPORTANCE);
        manager.createNotificationChannel(notificationChannel);
    }
    public void onClick(View view) {

        switch (view.getId()) {
            case R.id.notify_btn1:
                sendNormalNotify();
                break;
        }
    }
    /** 发送简单通知*/
    private void sendNormalNotify() {
//        创建通知的装饰对象
        Notification.Builder builder = null;
        if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.O) {
            builder = new Notification.Builder(this, CHANNEL_ID);
        }
        else{
            builder = new Notification.Builder(this);
        }
//        设置通知显示内容
        builder.setContentTitle("好消息，好消息！！！");
        builder.setContentText("新冠疫情神奇消失了.......");
        builder.setSmallIcon(R.mipmap.ic_launcher);

        Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.mipmap.jinniu);
        builder.setLargeIcon(bitmap);

        builder.setAutoCancel(true);
        builder.setOngoing(false);    //侧滑能不能取消通知
        builder.setPriority(Notification.PRIORITY_HIGH);
        builder.setTicker("放心Go向你发来了双11问候，快来看我......");
//        设置点击预先跳转意图
        Intent intent = new Intent(this, NewsInfoActivity.class);

        builder.setContentIntent(PendingIntent
                .getActivity(this,100,intent,PendingIntent.FLAG_IMMUTABLE));
//      获取通知对象
        Notification notification = builder.build();

//        发送通知
        manager.notify(1,notification);
    }



}
</code></pre>
<h3>发送大图通知</h3>
<pre><code class="language-java"> private void sendBigImgNotify() {
        NotificationCompat.Builder builder
                = new NotificationCompat.Builder(this);
        NotificationCompat.BigPictureStyle style = new NotificationCompat.BigPictureStyle();
        Bitmap bm1 = BitmapFactory.decodeResource(getResources(), R.mipmap.jinniu);
        style.bigLargeIcon(bm1);
        style.setBigContentTitle("美图来袭.....");
        style.setSummaryText("每日壁纸更新更多内容，点击查看");
        builder.setStyle(style);
        builder.setShowWhen(true);
        //必须设置小图标
        builder.setSmallIcon(R.mipmap.ib_luck_normal);
        if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.O) {
            builder.setChannelId(CHANNEL_ID);
        }
        Notification nf = builder.build();
        manager.notify(2, nf);
    }
</code></pre>
<h3>发送多条消息通知</h3>
<pre><code class="language-java">    private void sendListNotify() {
        //        创建通知的装饰对象
        Notification.Builder builder = null;
        if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.O) {
            builder = new Notification.Builder(this, CHANNEL_ID);
        }
        else{
            builder = new Notification.Builder(this);
        }
        builder.setSmallIcon(R.mipmap.ic_launcher);
        builder.setContentTitle("今日卫健委发出通告");
        Notification.InboxStyle style = new Notification.InboxStyle();
        style.addLine("取消健康码");
        style.addLine("取消隔离");
        style.addLine("取消核酸检测");
        builder.setStyle(style);
        Notification notify = builder.build();
        manager.notify(3, notify);
    }
</code></pre>

  </article><div class="Toastify"></div><div></div><div class="bottomBar_bottomBar__uHU1W"><div class="bottomBar_text__iz3cM">Powerd by<a href="https://github.com/hixyl/YlBlog" target="_blank"> YlBlog(玉龙博客)</a></div></div></div></div></div></div><script src="/_next/static/chunks/webpack-33ea8a143bfabde9.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/a34f9d1faa5f3315-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/css/aae87c042353adfd.css\",\"style\"]\n3:HL[\"/_next/static/css/99f6a99e5e57ec87.css\",\"style\"]\n4:HL[\"/_next/static/css/d0df4e9d9cd28850.css\",\"style\"]\n5:HL[\"/_next/static/css/c033a265c4b6e7f8.css\",\"style\"]\n6:HL[\"/_next/static/css/81abeb1d965206f7.css\",\"style\"]\n7:HL[\"/_next/static/css/a46a6036119d7d12.css\",\"style\"]\n8:HL[\"/_next/static/css/51cbc18a5b192d8f.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"9:I[5751,[],\"\"]\nc:I[9275,[],\"\"]\ne:I[1343,[],\"\"]\nf:I[4080,[\"185\",\"static/chunks/app/layout-950680b5068c0831.js\"],\"\"]\n10:I[4266,[\"185\",\"static/chunks/app/layout-950680b5068c0831.js\"],\"default\"]\n12:I[6130,[],\"\"]\nd:[\"id\",\"11%E6%9C%8811%E6%97%A5Android%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0\",\"d\"]\n13:[]\n"])</script><script>self.__next_f.push([1,"0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/aae87c042353adfd.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L9\",null,{\"buildId\":\"bbFeRMIduFcZud7BNs8NQ\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/article/11%E6%9C%8811%E6%97%A5Android%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/\",\"initialTree\":[\"\",{\"children\":[\"article\",{\"children\":[[\"id\",\"11%E6%9C%8811%E6%97%A5Android%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0\",\"d\"],{\"children\":[\"__PAGE__?{\\\"id\\\":\\\"11月11日Android学习笔记\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"article\",{\"children\":[[\"id\",\"11%E6%9C%8811%E6%97%A5Android%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$La\",\"$Lb\"],null],null]},[\"$\",\"$Lc\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"article\",\"children\",\"$d\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Le\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/99f6a99e5e57ec87.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/d0df4e9d9cd28850.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"2\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/c033a265c4b6e7f8.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"3\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/81abeb1d965206f7.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"4\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/a46a6036119d7d12.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"5\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/51cbc18a5b192d8f.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]}],null]},[\"$\",\"$Lc\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"article\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Le\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"html\",null,{\"lang\":\"zh\",\"children\":[[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.png?\u003cgenerated\u003e\",\"type\":\"image/\u003cgenerated\u003e\",\"sizes\":\"\u003cgenerated\u003e\"}],[\"$\",\"$Lf\",null,{\"src\":\"https://www.googletagmanager.com/gtag/js?id=G-N3DJ3JTVT2\"}],[\"$\",\"$Lf\",null,{\"id\":\"google-analytics\",\"children\":\"\\n          window.dataLayer = window.dataLayer || [];\\n          function gtag(){dataLayer.push(arguments);}\\n          gtag('js', new Date());\\n        \\n          gtag('config', 'G-N3DJ3JTVT2');\\n        \"}],[\"$\",\"body\",null,{\"className\":\"__className_36bd41\",\"children\":[[\"$\",\"$Lc\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Le\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}],[\"$\",\"$L10\",null,{}]]}]]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$L11\"],\"globalErrorComponent\":\"$12\",\"missingSlots\":\"$W13\"}]]\n"])</script><script>self.__next_f.push([1,"14:I[2612,[\"577\",\"static/chunks/221e729c-e5a67d23aac7644c.js\",\"231\",\"static/chunks/9316e0b3-81def07e0919db1c.js\",\"974\",\"static/chunks/974-9ffea8f9ea4bfaa2.js\",\"536\",\"static/chunks/536-12c341f043d96047.js\",\"665\",\"static/chunks/665-f7c57b2084cbed6b.js\",\"241\",\"static/chunks/app/article/%5Bid%5D/page-28a3798f9eb189fc.js\"],\"default\"]\n15:I[4306,[\"577\",\"static/chunks/221e729c-e5a67d23aac7644c.js\",\"231\",\"static/chunks/9316e0b3-81def07e0919db1c.js\",\"974\",\"static/chunks/974-9ffea8f9ea4bfaa2.js\",\"536\",\"static/chunks/536-12c341f043d96047.js\",\"665\",\"static/chunks/665-f7c57b2084cbed6b.js\",\"241\",\"static/chunks/app/article/%5Bid%5D/page-28a3798f9eb189fc.js\"],\"default\"]\n16:I[231,[\"577\",\"static/chunks/221e729c-e5a67d23aac7644c.js\",\"231\",\"static/chunks/9316e0b3-81def07e0919db1c.js\",\"974\",\"static/chunks/974-9ffea8f9ea4bfaa2.js\",\"536\",\"static/chunks/536-12c341f043d96047.js\",\"665\",\"static/chunks/665-f7c57b2084cbed6b.js\",\"241\",\"static/chunks/app/article/%5Bid%5D/page-28a3798f9eb189fc.js\"],\"\"]\n17:I[4254,[\"577\",\"static/chunks/221e729c-e5a67d23aac7644c.js\",\"231\",\"static/chunks/9316e0b3-81def07e0919db1c.js\",\"974\",\"static/chunks/974-9ffea8f9ea4bfaa2.js\",\"536\",\"static/chunks/536-12c341f043d96047.js\",\"665\",\"static/chunks/665-f7c57b2084cbed6b.js\",\"241\",\"static/chunks/app/article/%5Bid%5D/page-28a3798f9eb189fc.js\"],\"default\"]\n19:I[3869,[\"577\",\"static/chunks/221e729c-e5a67d23aac7644c.js\",\"231\",\"static/chunks/9316e0b3-81def07e0919db1c.js\",\"974\",\"static/chunks/974-9ffea8f9ea4bfaa2.js\",\"536\",\"static/chunks/536-12c341f043d96047.js\",\"665\",\"static/chunks/665-f7c57b2084cbed6b.js\",\"241\",\"static/chunks/app/article/%5Bid%5D/page-28a3798f9eb189fc.js\"],\"default\"]\n1a:I[5339,[\"577\",\"static/chunks/221e729c-e5a67d23aac7644c.js\",\"231\",\"static/chunks/9316e0b3-81def07e0919db1c.js\",\"974\",\"static/chunks/974-9ffea8f9ea4bfaa2.js\",\"536\",\"static/chunks/536-12c341f043d96047.js\",\"665\",\"static/chunks/665-f7c57b2084cbed6b.js\",\"241\",\"static/chunks/app/article/%5Bid%5D/page-28a3798f9eb189fc.js\"],\"Waline\"]\n1b:I[8360,[\"577\",\"static/chunks/221e729c-e5a67d23aac7644c.js\",\"231\",\"st"])</script><script>self.__next_f.push([1,"atic/chunks/9316e0b3-81def07e0919db1c.js\",\"974\",\"static/chunks/974-9ffea8f9ea4bfaa2.js\",\"536\",\"static/chunks/536-12c341f043d96047.js\",\"665\",\"static/chunks/665-f7c57b2084cbed6b.js\",\"241\",\"static/chunks/app/article/%5Bid%5D/page-28a3798f9eb189fc.js\"],\"default\"]\n1c:I[4226,[\"577\",\"static/chunks/221e729c-e5a67d23aac7644c.js\",\"231\",\"static/chunks/9316e0b3-81def07e0919db1c.js\",\"974\",\"static/chunks/974-9ffea8f9ea4bfaa2.js\",\"536\",\"static/chunks/536-12c341f043d96047.js\",\"665\",\"static/chunks/665-f7c57b2084cbed6b.js\",\"241\",\"static/chunks/app/article/%5Bid%5D/page-28a3798f9eb189fc.js\"],\"default\"]\n18:T3fa0,"])</script><script>self.__next_f.push([1,"\n    \u003cp class=\"time\"\u003e发布时间：\u003ctime datetime=\"11 November, 2022\"\u003e2022-11-11 17:17:11\u003c/time\u003e\u003c/p\u003e\n    \u003cp class=\"words\"\u003e本文字数：2,028 字       阅读完需：约 5 分钟\u003c/p\u003e\n    \u003ch2\u003eAndroid 异步任务\u003c/h2\u003e\n\u003ch3\u003eInfoAsyncTask.java\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-java\"\u003epackage com.xyl.app1111;\n\nimport android.app.ProgressDialog;\nimport android.content.Context;\nimport android.os.AsyncTask;\nimport android.text.TextUtils;\nimport android.util.Log;\n\nimport com.xyl.app1111.utils.HttpUtils;\n\npublic class InfoAsyncTask extends AsyncTask\u0026#x3C;String, Void, String\u003e {\n\n    private Context context;\n    private ProgressDialog dialog;\n    public interface OnLoadDataListener{\n        public void onSuccess(String json);\n        public void onError();\n    }\n    private OnLoadDataListener onLoadDataListener;\n    public void setOnLoadDataListener(OnLoadDataListener onLoadDataListener){\n        this.onLoadDataListener = onLoadDataListener;\n    }\n\n    public InfoAsyncTask(Context context) {\n        this.context = context;\n    }\n\n    /**\n     * 在子线程开启之前被调用，运行在主线程当中，通常做进度对话框的初始化工作\n     */\n    @Override\n    protected void onPreExecute() {\n        super.onPreExecute();\n        dialog = new ProgressDialog(context);\n        dialog.setMessage(\"正在加载中，请稍后\");\n        dialog.show();\n    }\n\n    /**\n     * 开启线程，进行耗时操作\n     * @param params\n     * @return\n     */\n    @Override\n    protected String doInBackground(String... params) {\n        String s = HttpUtils.getStringByConnection(params[0]);\n        return s;\n    }\n\n    /**\n     * 计算下载的进度，在此处更新进度条\n     * @param values\n     */\n    @Override\n    protected void onProgressUpdate(Void... values) {\n        super.onProgressUpdate(values);\n    }\n\n    /**\n     * 运行在主线程当中，将耗时操作的结果以参数的形式显示在参数当中,result为doInBackground的返回值\n     * @param result\n     */\n    @Override\n    protected void onPostExecute(String result) {\n        super.onPostExecute(result);\n        dialog.dismiss();\n        if (onLoadDataListener!=null) {\n            if (!TextUtils.isEmpty(result)) {\n                onLoadDataListener.onSuccess(result);\n            }\n            else{\n                onLoadDataListener.onError();\n            }\n        }\n    }\n}\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e异步请求底层模拟\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-java\"\u003epackage com.animee.app1111.utils;\n\n\nimport android.os.Handler;\nimport android.os.Message;\n\nimport androidx.annotation.NonNull;\n\n/**\n * 作者：animee on 2022/11/11 09:51\n */\npublic abstract  class AnimeeTask\u0026#x3C;T,M\u003e {\n\n    protected void onPreExecute(){\n\n    }\n    protected abstract M doInBackground(T...params);\n    protected void onPostExecute(M result){\n\n    }\n\n    public AnimeeTask(){\n        onPreExecute();\n    }\n\n    public void execute(T...value){\n        Thread thread = new Thread(new Runnable() {\n            @Override\n            public void run() {\n                M m = doInBackground(value);\n                //Message对象获取方法有三个\n                Message msg = Message.obtain();\n                msg.what = 1;\n                msg.obj = m;\n                handler.sendMessage(msg);\n\n            }\n        });\n        thread.start();\n    }\n    Handler handler = new Handler(new Handler.Callback() {\n        @Override\n        public boolean handleMessage(@NonNull Message msg) {\n            if (msg.what==1) {\n                M m = (M) msg.obj;\n                onPostExecute(m);\n            }\n            return false;\n        }\n    });\n}\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e知识点\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-text\"\u003e1.android处理网络请求等耗时操作的方法，有两种：\n  1.异步任务   AsyncTask\n  2.多线程和线程池    Handler\n\n2.为什么要使用异步任务？\n      1.Android是一个单线程模型，同时也是一个多线程操作系统。\n    2.把耗时操作(读取文件，加载网络请求)放到子线程当中执行。\n原因：android只能在主线程当中更新ui，即UI线程，不能在其他线程当中做更新ui的操作。\n这样保证了程序的稳定性和准确性。\n稳定性：避免了多线程同时操作ui，造成了线程混乱。\n准备性：把耗时操作都放到子线程当中执行，就会避免了ANR(Android Not Responding)应用程序无响应异常。\n\n3.AsyncTask为何而生？\n       1.可以封装，简化异步操作\n       2.获取网络数据，传递给主线程更新UI。\n\n4.构建AsyncTask子类的参数、\nAsyncTask\u0026#x3C;params,progress,result\u003e是一个抽象类。\n通常用于被继承，继承这个asyncTask就需要指定三个泛型参数。\n    Params:启动任务时输入参数的类型\n    Progress：后台任务执行中返回进度值的类型\n    Result: 后台任务执行完返回结果的类型。\n\n5.继承AsyncTask当中需要重写的四个方法。\n\nonPreExecute():后台操作前被调用，主要用于一些UI组件的初始化。（不做耗时操作）\ndoInBackground(Params...)：必须重写，异步任务要执行的操作必须在这个方法中执行。(执行耗时操作)\nonPostExecute(Result):在doInBackground方法执行完成后，自动调用此方法，同时doInBackground方法返回的数据\n            会作为此方法的参数。一般在此方法中去执行更新ui的操作。\nonProgressUpdate(Progress...)：更新了任务执行就进度后，会触发的方法。在doInBackground方法当中调用\n                publishProgress(Progress...)方法，此方法才会被系统调用。\n\n\n6.AsyncTask的具体实现过程。\n      1.写一个类，继承asyncTask，同时传入指定的三个泛型\n    2.重写必要的两个方法。\n            doInBackground();\n        onPostExecute();\n    3.重写可选的两个方法。\n            onPreExecute();\n        onProgressUpdate();\n    4.在ui线程当中实例化，自定义的子类的对象。\n    5.在ui线程当中，把asynctask的对象去执行execute的方法,就是执行了异步任务。\n\n\n7.ScrollView  :  滚动组件\n  父类是：Framelayout\n   内部只能包含一个子类控件，通常这个控件是LinearLayout，可以在线性布局当中去放置其他控件。\n\n8、android的view有一个表示显示状态的属性visibility。\n  对应的值有三个：\n   visible:设置控件可见\n   invisible:设置控件不可见\n   gone:设置控件隐藏\n   invisible和gone的主要区别：当设置为invisible时，界面保留view控件所占据的空间。\n   当设定为gone时，view隐藏并且不保留view控件所占据的空间。\n\n9.AsyncTask的不足之处。\n     1.AsyncTask如果在同一个界面当中加载很多接口，会开启大量的线程，会导致系统资源严重被占用，\n      然后就会产生应用程序FC错误。（FC:应用程序强制关闭，崩溃）\n   2.AsyncTask执行doinBackground方法时，即使调用了取消方法，也不能取消，要等到doinBackground\n   方法中的代码执行结束后才能取消。\n   3.线程池是不能维护的，当产生大量异步操作的时候线程池就满了，然后就会产生异常。\n\n10.异步和同步\n     同步：在同一个线程当中执行一系列的操作。\n   异步：多个线程当中完成工作，最后通过多线程通信达到最终效果。\n\n11.AsyncTask的取消。\n     1.要在UI线程当中执行AsyncTask的cancel方法。\n   2.要在doInBackground方法当中做一个判断，判断条件是是否被取消isCancelled(),如果未被取消才执行逻辑代码。\n   3.cancel(true)   ：只要是执行了这个方法，AsyncTask立即被取消。\n     cancel(false)  : 执行了这个方法，要等本次while中的内容执行完才被取消。\n\n12.AsyncTask的注意事项：\n      1.必须在UI线程当中创建AsyncTask的实例。\n    2.必须在ui线程当中执行AsyncTask的execute的方法。\n    3.重写的四个方法是系统自动调用的，我们不能手动的调用。\n    4.每个asyncTask的实例只能被执行一次，多次执行就会出现异常。\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e滚动分页加载\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"language-java\"\u003e   //ListView 滚动监听接口\n    AbsListView.OnScrollListener listener = new AbsListView.OnScrollListener() {\n        // 当滚动状态发生改变时，回调的方法\n//        SCROLL_STATE_IDLE 停止状态  SCROLL_STATE_TOUCH_SCROLL 手指触摸滚动\n//        SCROLL_STATE_FLING 惯性滚动\n        @Override\n        public void onScrollStateChanged(AbsListView view, int scrollState) {\n            if (scrollState == SCROLL_STATE_IDLE\n                    \u0026#x26;\u0026#x26; lastVisibleItem==adapter.getCount()) {\n                //显示尾布局，并且开始加载\n                footerView.setVisibility(View.VISIBLE);\n                page++;\n                String url = creatURL();\n                loadDatas(url);\n            }\n        }\n        //    firstVisibleItem：当前可见第一条的位置   visibleItemCount 可见条目数量   totalItemCount 一共有多少条\n        @Override\n        public void onScroll(AbsListView view, int firstVisibleItem, int visibleItemCount, int totalItemCount) {\n            lastVisibleItem = firstVisibleItem+visibleItemCount-1;\n        }\n    };\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e下拉刷新\u003c/h2\u003e\n\u003ch3\u003ebuild.gradle\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-java\"\u003e    implementation \"androidx.swiperefreshlayout:swiperefreshlayout:1.0.0\"\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e使用\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-java\"\u003e    binding.srLayout.setColorSchemeColors(Color.RED);\n    binding.srLayout.setOnRefreshListener(onRefreshListener);\n    //    下拉刷新的监听接口\n    SwipeRefreshLayout.OnRefreshListener onRefreshListener = new SwipeRefreshLayout.OnRefreshListener() {\n        @Override\n        public void onRefresh() {\n            page=1;\n            String url = creatURL();\n            mDatas.clear();\n            loadDatas(url);\n        }\n    };\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e通知(Notification)\u003c/h2\u003e\n\u003ch3\u003e发送简单通知\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-java\"\u003e    /**\n     * 发送简单通知\n     */\n    private void sendNormalNotify() {\n        //创建通知的装饰对象\n        Notification.Builder builder = new Notification.Builder(this);\n        //设置通知显示内容\n        builder.setContentTitle(\"好消息, 好消息！！！！\");\n        builder.setContentText(\"新冠疫情神奇消失了。。。\");\n        builder.setSmallIcon(R.mipmap.ib_luck_normal);\n        Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.mipmap.jinniu);\n        builder.setLargeIcon(bitmap);\n        builder.setAutoCancel(true);\n        builder.setOngoing(false);//侧滑能不能取消通知\n        builder.setPriority(Notification.PRIORITY_HIGH);\n        builder.setTicker(\"放心Go向你发来了双11问候，快来看我.....\");\n        //设置点击预先跳转意图\n        Intent intent = new Intent(this, NewsInfoActivity.class);\n        builder.setContentIntent(PendingIntent.getActivity(this, 100, intent, PendingIntent.FLAG_ONE_SHOT));\n        //获取通知对象\n        Notification notification = builder.build();\n        //发送通知\n        manager.notify(1, notification);\n    }\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e完整实例\u003c/h3\u003e\n\u003cp\u003e注意: Andorid\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-java\"\u003eimport androidx.appcompat.app.AppCompatActivity;\n\nimport android.app.Notification;\nimport android.app.NotificationChannel;\nimport android.app.NotificationManager;\nimport android.app.PendingIntent;\nimport android.content.Context;\nimport android.content.Intent;\nimport android.graphics.Bitmap;\nimport android.graphics.BitmapFactory;\nimport android.os.Build;\nimport android.os.Bundle;\nimport android.view.View;\n\n/**\n * Notification  通知信息\n * 在应用中如果需要提示用户一些信息，显示在通知栏，可以发送Notification\n *\n * */\npublic class NotifyActivity extends AppCompatActivity {\n\n    NotificationManager manager;\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_notify);\n        manager =\n                (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);\n        createChannel();\n\n    }\n    private final String CHANNEL_ID = \"com.animee.app1111\";\n    //渠道名\n    private final String CHANNEL_NAME = \"渠道名-简单通知\";\n    //渠道重要级\n    private final int CHANNEL_IMPORTANCE = NotificationManager.IMPORTANCE_DEFAULT;\n    private void createChannel() {\n        //创建通知渠道，Android8.0及以上需要\n        if (Build.VERSION.SDK_INT \u0026#x3C; Build.VERSION_CODES.O) {\n            return;\n        }\n        NotificationChannel notificationChannel = new NotificationChannel(\n                CHANNEL_ID, CHANNEL_NAME, CHANNEL_IMPORTANCE);\n        manager.createNotificationChannel(notificationChannel);\n    }\n    public void onClick(View view) {\n\n        switch (view.getId()) {\n            case R.id.notify_btn1:\n                sendNormalNotify();\n                break;\n        }\n    }\n    /** 发送简单通知*/\n    private void sendNormalNotify() {\n//        创建通知的装饰对象\n        Notification.Builder builder = null;\n        if (android.os.Build.VERSION.SDK_INT \u003e= android.os.Build.VERSION_CODES.O) {\n            builder = new Notification.Builder(this, CHANNEL_ID);\n        }\n        else{\n            builder = new Notification.Builder(this);\n        }\n//        设置通知显示内容\n        builder.setContentTitle(\"好消息，好消息！！！\");\n        builder.setContentText(\"新冠疫情神奇消失了.......\");\n        builder.setSmallIcon(R.mipmap.ic_launcher);\n\n        Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.mipmap.jinniu);\n        builder.setLargeIcon(bitmap);\n\n        builder.setAutoCancel(true);\n        builder.setOngoing(false);    //侧滑能不能取消通知\n        builder.setPriority(Notification.PRIORITY_HIGH);\n        builder.setTicker(\"放心Go向你发来了双11问候，快来看我......\");\n//        设置点击预先跳转意图\n        Intent intent = new Intent(this, NewsInfoActivity.class);\n\n        builder.setContentIntent(PendingIntent\n                .getActivity(this,100,intent,PendingIntent.FLAG_IMMUTABLE));\n//      获取通知对象\n        Notification notification = builder.build();\n\n//        发送通知\n        manager.notify(1,notification);\n    }\n\n\n\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e发送大图通知\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-java\"\u003e private void sendBigImgNotify() {\n        NotificationCompat.Builder builder\n                = new NotificationCompat.Builder(this);\n        NotificationCompat.BigPictureStyle style = new NotificationCompat.BigPictureStyle();\n        Bitmap bm1 = BitmapFactory.decodeResource(getResources(), R.mipmap.jinniu);\n        style.bigLargeIcon(bm1);\n        style.setBigContentTitle(\"美图来袭.....\");\n        style.setSummaryText(\"每日壁纸更新更多内容，点击查看\");\n        builder.setStyle(style);\n        builder.setShowWhen(true);\n        //必须设置小图标\n        builder.setSmallIcon(R.mipmap.ib_luck_normal);\n        if (android.os.Build.VERSION.SDK_INT \u003e= android.os.Build.VERSION_CODES.O) {\n            builder.setChannelId(CHANNEL_ID);\n        }\n        Notification nf = builder.build();\n        manager.notify(2, nf);\n    }\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e发送多条消息通知\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-java\"\u003e    private void sendListNotify() {\n        //        创建通知的装饰对象\n        Notification.Builder builder = null;\n        if (android.os.Build.VERSION.SDK_INT \u003e= android.os.Build.VERSION_CODES.O) {\n            builder = new Notification.Builder(this, CHANNEL_ID);\n        }\n        else{\n            builder = new Notification.Builder(this);\n        }\n        builder.setSmallIcon(R.mipmap.ic_launcher);\n        builder.setContentTitle(\"今日卫健委发出通告\");\n        Notification.InboxStyle style = new Notification.InboxStyle();\n        style.addLine(\"取消健康码\");\n        style.addLine(\"取消隔离\");\n        style.addLine(\"取消核酸检测\");\n        builder.setStyle(style);\n        Notification notify = builder.build();\n        manager.notify(3, notify);\n    }\n\u003c/code\u003e\u003c/pre\u003e\n\n  "])</script><script>self.__next_f.push([1,"b:[\"$\",\"div\",null,{\"className\":\"article_pageBody__Bryg4\",\"children\":[[\"$\",\"$L14\",null,{\"menuItemList\":[{\"id\":0,\"label\":\"首页\",\"href\":\"/\",\"icon\":\"/icons/home_gray.svg\",\"iconSelected\":\"/icons/home_black.svg\"},{\"id\":1,\"label\":\"文章\",\"href\":\"/articles/all/1\",\"icon\":\"/icons/article_gray.svg\",\"iconSelected\":\"/icons/article_black.svg\"},{\"id\":3,\"label\":\"关于\",\"href\":\"/about\",\"icon\":\"/icons/about_gray.svg\",\"iconSelected\":\"/icons/about_black.svg\"},{\"id\":4,\"label\":\"搜索\",\"href\":\"/search\",\"icon\":\"/icons/search_gray.svg\",\"iconSelected\":\"/icons/search_black.svg\"}],\"currentSelectedLabel\":\"文章\"}],[\"$\",\"div\",null,{\"className\":\"article_pageBodyMain___x_AF\",\"children\":[[\"$\",\"$L15\",null,{}],[\"$\",\"div\",null,{\"className\":\"article_articleContainer__uRwUh scrollContent\",\"children\":[[\"$\",\"div\",null,{\"className\":\"article_articleBody__0coIY scrollContent\",\"children\":[[\"$\",\"h1\",null,{\"style\":{\"marginBottom\":\"0.1rem\",\"marginTop\":\"0.2rem\"},\"children\":\"11月11日Android学习笔记\"}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"tags_tags__qM_Ja\",\"children\":[[\"$\",\"p\",null,{\"className\":\"tags_label__Rg6b2\",\"children\":\"分类\"}],[[\"$\",\"$L16\",\"0\",{\"href\":\"/articles/新知笔记/1\",\"children\":[\"$\",\"p\",\"0\",{\"className\":\"tags_tag__HZYxk tags_tagLink__gnw9V\",\"children\":\"新知笔记\"}]}],[\"$\",\"$L16\",\"1\",{\"href\":\"/articles/Android学习/1\",\"children\":[\"$\",\"p\",\"1\",{\"className\":\"tags_tag__HZYxk tags_tagLink__gnw9V\",\"children\":\"Android学习\"}]}]],false]}],[\"$\",\"div\",null,{\"className\":\"tags_tags__qM_Ja\",\"children\":[[\"$\",\"p\",null,{\"className\":\"tags_label__Rg6b2\",\"children\":\"标签\"}],\"$undefined\",[[\"$\",\"p\",\"0\",{\"className\":\"tags_tag__HZYxk \",\"children\":\"Android\"}],[\"$\",\"p\",\"1\",{\"className\":\"tags_tag__HZYxk \",\"children\":\"Thread\"}],[\"$\",\"p\",\"2\",{\"className\":\"tags_tag__HZYxk \",\"children\":\"AsyncTask\"}],[\"$\",\"p\",\"3\",{\"className\":\"tags_tag__HZYxk \",\"children\":\"Notification\"}]]]}],[\"$\",\"$L17\",null,{\"path\":\"11%E6%9C%8811%E6%97%A5Android%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0\",\"serverURL\":\"https://remark.timeshike.com/\"}]]}],[\"$\",\"article\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$18\"}}],[\"$\",\"$L19\",null,{}],[\"$\",\"$L1a\",null,{\"path\":\"11%E6%9C%8811%E6%97%A5Android%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0\",\"serverURL\":\"https://remark.timeshike.com/\",\"lang\":\"zh-CN\"}],[\"$\",\"div\",null,{\"className\":\"bottomBar_bottomBar__uHU1W\",\"children\":[\"$\",\"div\",null,{\"className\":\"bottomBar_text__iz3cM\",\"children\":[\"Powerd by\",[\"$\",\"a\",null,{\"href\":\"https://github.com/hixyl/YlBlog\",\"target\":\"_blank\",\"children\":\" YlBlog(玉龙博客)\"}]]}]}]]}],[\"$\",\"$L1b\",null,{}]]}]]}],[\"$\",\"$L1c\",null,{}]]}]\n"])</script><script>self.__next_f.push([1,"11:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"11月11日Android学习笔记 - 流年石刻\"}],[\"$\",\"meta\",\"3\",{\"name\":\"next-size-adjust\"}]]\na:null\n"])</script></body></html>